name: Publish Python ğŸ distributions ğŸ“¦ to PyPI
on:
  push:
    branches:
      - master
jobs:
  build-and-publish:
    name: Build and publish Python ğŸ distributions ğŸ“¦ to PyPI
    runs-on: ubuntu-latest
  steps:
  - uses: actions/checkout@master
  - name: Set up Python 3.8
    uses: actions/setup-python@v1
    with:
      python-version: 3.8

  - name: Build Zoomba
    run: |
      python -m pip install --upgrade pip
      pip install .

  - name: Build a binary wheel and a source tarball
    run: |
      python -m build --sdist --wheel --outdir dist/ .

  - name: Publish distribution ğŸ“¦ to PyPI
    if: startsWith(github.ref, 'refs/tags')
    uses: pypa/gh-action-pypi-publish@master
    with:
      password: ${{ secrets.PYPI_API_TOKEN }}